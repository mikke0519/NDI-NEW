<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ET-2問題集 インタラクティブ学習</title>
  <style>
    :root {
      --primary: #2563eb;
      --primary-light: #3b82f6;
      --correct: #22c55e;
      --incorrect: #ef4444;
      --explanation-bg: #f1f5f9;
      --container-bg: #fff;
      --shadow: 0 4px 24px rgba(0,0,0,0.08);
      --radius: 1.2rem;
      --transition: 0.3s cubic-bezier(.4,2,.6,1);
      --font: "Segoe UI", "Meiryo", "Hiragino Kaku Gothic ProN", Arial, sans-serif;
    }
    body {
      background: linear-gradient(135deg, #e0e7ff 0%, #f1f5f9 100%);
      min-height: 100vh;
      margin: 0;
      font-family: var(--font);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    #quiz-container {
      background: var(--container-bg);
      box-shadow: var(--shadow);
      border-radius: var(--radius);
      padding: 2rem 1.5rem 1.5rem 1.5rem;
      max-width: 480px;
      width: 100%;
      margin: 2rem;
      display: flex;
      flex-direction: column;
      gap: 1.2rem;
    }
    #progress-text {
      font-size: 1.1rem;
      color: var(--primary);
      font-weight: 600;
      letter-spacing: 0.05em;
      text-align: right;
    }
    #question-container {
      display: flex;
      align-items: flex-start;
      gap: 0.7rem;
    }
    #question-text {
      font-size: 1.2rem;
      font-weight: 500;
      margin: 0;
      flex: 1;
      line-height: 1.6;
    }
    #speak-button {
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      color: var(--primary-light);
      transition: color var(--transition);
      margin-top: 0.2em;
      padding: 0.2em 0.4em;
      border-radius: 50%;
    }
    #speak-button:hover {
      color: var(--primary);
      background: #e0e7ff;
    }
    #choices-container {
      display: flex;
      flex-direction: column;
      gap: 0.7rem;
      margin-top: 0.5rem;
    }
    .choice-btn {
      font-size: 1.08rem;
      padding: 0.9em 1em;
      border: 2px solid #e5e7eb;
      border-radius: 0.7em;
      background: #f8fafc;
      color: #222;
      cursor: pointer;
      transition: background var(--transition), color var(--transition), border var(--transition);
      text-align: left;
      outline: none;
      font-family: inherit;
      font-weight: 500;
    }
    .choice-btn:hover:not(:disabled) {
      background: var(--primary-light);
      color: #fff;
      border-color: var(--primary-light);
    }
    .choice-btn:disabled {
      cursor: not-allowed;
      opacity: 0.8;
    }
    .choice-btn.correct {
      background: var(--correct);
      color: #fff;
      border-color: var(--correct);
      animation: pop 0.25s;
    }
    .choice-btn.incorrect {
      background: var(--incorrect);
      color: #fff;
      border-color: var(--incorrect);
      animation: shake 0.25s;
    }
    @keyframes pop {
      0% { transform: scale(1); }
      60% { transform: scale(1.08); }
      100% { transform: scale(1); }
    }
    @keyframes shake {
      0% { transform: translateX(0); }
      25% { transform: translateX(-6px); }
      50% { transform: translateX(6px); }
      75% { transform: translateX(-4px); }
      100% { transform: translateX(0); }
    }
    #explanation-container {
      background: var(--explanation-bg);
      border-radius: 0.7em;
      margin-top: 0.8em;
      padding: 1em 1em 0.9em 1em;
      color: #222;
      font-size: 1.05rem;
      line-height: 1.7;
      box-shadow: 0 2px 10px rgba(37,99,235,0.04);
      opacity: 0;
      transform: translateY(30px);
      pointer-events: none;
      transition: opacity 0.6s var(--transition), transform 0.6s var(--transition);
      display: none;
    }
    #explanation-container.visible {
      display: block;
      opacity: 1;
      pointer-events: auto;
      transform: translateY(0);
    }
    #navigation-container {
      display: flex;
      justify-content: space-between;
      gap: 1.2em;
      margin-top: 1.2em;
    }
    #prev-button, #next-button {
      flex: 1;
      font-size: 1.07rem;
      padding: 0.7em 1em;
      border: none;
      border-radius: 0.7em;
      background: var(--primary-light);
      color: #fff;
      font-weight: 600;
      cursor: pointer;
      transition: background var(--transition), box-shadow var(--transition);
      box-shadow: 0 2px 8px rgba(37,99,235,0.05);
    }
    #prev-button:hover, #next-button:hover {
      background: var(--primary);
    }
    @media (max-width: 600px) {
      #quiz-container {
        max-width: 98vw;
        padding: 1.2rem 0.3rem 1rem 0.3rem;
        margin: 0.5rem;
      }
      #question-text {
        font-size: 1.08rem;
      }
      .choice-btn {
        font-size: 0.99rem;
        padding: 0.8em 0.7em;
      }
      #explanation-container {
        font-size: 0.98rem;
        padding: 0.7em 0.7em 0.7em 0.7em;
      }
      #prev-button, #next-button {
        font-size: 1rem;
        padding: 0.6em 0.3em;
      }
    }
  </style>
</head>
<body>
  <div id="quiz-container">
    <div id="progress-text"></div>
    <div id="question-container">
      <p id="question-text"></p>
      <button id="speak-button" title="読み上げ"><span aria-label="読み上げ">🔊</span></button>
      <button id="pause-button" title="一時停止"><span aria-label="一時停止">⏸️</span></button>
    </div>
    <div id="choices-container"></div>
    <div id="explanation-container"></div>
    <div id="navigation-container">
      <button id="prev-button">前へ</button>
      <button id="next-button">次へ</button>
    </div>
  </div>
  <script>
    // --- 問題データ ---
    const quizData = [
  {id:"1.1",question:"1.1~次の文は、渦電流探傷試験を適用する試験体について述べたものである。正しいものを一つ選び、記号で答えなさい。",choices:["強磁性体でなければならない。","非磁性体でなければならない。","導体でなければならない。","絶縁体でなければならない。"],correct_option_index:2,explanation:"渦電流探傷試験は、電磁誘導現象を利用して導体内に渦電流を発生させる手法です。そのため、試験対象は電気を通す導体である必要があります。"},
  {id:"1.2",question:"1.2~次の文は、渦電流探傷試験において試験体に誘導される渦電流について述べたものである。正しいものを一つ選び、記号で答えなさい。",choices:["コイルの熱の作用によって誘導される。","コイルの磁束の作用によって誘導される。","コイルの表皮効果によって試験体に誘導される。","コイルの端末効果によって試験体に誘導される。"],correct_option_index:1,explanation:"試験コイルに交流を流すと時間的に変化する磁束が発生します。この交流磁束が導体を貫くことで、磁束の変化を打ち消す向きに渦電流が誘導されます。これを電磁誘導現象といいます。"},
  {id:"1.3",question:"1.3~渦電流探傷試験は、次に示すいずれの作用を利用しているか。正しいものを一つ選び、記号で答えなさい。",choices:["光電効果","静電誘導現象","電磁誘導現象","圧電効果"],correct_option_index:2,explanation:"渦電流探傷試験の原理は、コイルと導体との間で起こる電磁誘導現象に基づいています。"},
  {id:"1.4",question:"1.4~渦電流探傷試験は何のエネルギーを利用しているか。次のうちから正しいものを一つ選び、記号で答えなさい。",choices:["静電エネルギー","音響エネルギー","電磁気エネルギー","光エネルギー"],correct_option_index:2,explanation:"コイルが作る磁界と、それによって導体に流れる渦電流は電磁気的な現象であり、利用しているのは電磁気エネルギーです。"},
  {id:"1.5",question:"1.5~渦電流探傷試験に最も関係の深いものは、次のうちどれか。正しいものを一つ選び、記号で答えなさい。",choices:["漏れ磁束","熱電子","渦電流","磁気ひずみ"],correct_option_index:2,explanation:"渦電流探傷試験は、試験体に誘導した「渦電流」の変化を捉えることで、きずの検出や材質評価を行います。"},
  {id:"1.6",question:"1.6~次の文は、渦電流探傷試験の原理について述べたものである。正しいものを一つ選び、記号で答えなさい。",choices:["試験コイルに直流を流すと、試験体内に渦電流が誘導されることを利用する。","試験体表面のきずによって、渦電流の流れが変化することを利用する。","渦電流の周波数が、きずによって変化することを利用する。","試験体表面のきずの部分が磁気飽和することを利用する。"],correct_option_index:1,explanation:"電磁誘導で発生した渦電流は、きず（不連続部）があると流れが妨げられて変化します。この渦電流の変化をコイルのインピーダンス変化として捉えるのが渦電流探傷試験の原理です。"},
  {id:"1.7",question:"1.7~次の文は、渦電流探傷試験の原理について述べたものである。正しいものを一つ選び、記号で答えなさい。",choices:["渦電流は、試験体にきずがあると磁気飽和する。","渦電流は、試験体表面からの深さには無関係に流れる。","渦電流は、試験体表面に平行な方向に流れる。","渦電流は、きずがあっても流れは一定である。"],correct_option_index:2,explanation:"自己誘導型プローブ（貫通型や内挿型を含む）では、コイルの作る一次磁束によって、試験体表面に平行な円周状の渦電流が流れます。"},
  {id:"1.8",question:"1.8~渦電流が誘導されない材料は、次のうちどれか。正しいものを一つ選び、記号で答えなさい。",choices:["ジュラルミン","銅","鋼","ベークライト"],correct_option_index:3,explanation:"渦電流は導体に誘導される電流です。ベークライトは電気を通さない絶縁体なので、渦電流は誘導されません。"},
  {id:"1.9",question:"1.9~次の文は、渦電流探傷試験について述べたものである。正しいものを一つ選び、記号で答えなさい。",choices:["渦電流は、試験体の磁気特性には影響されない。","試験コイルと試験体との間の距離が変化しても、コイルのインピーダンスは変化しない。","試験コイルに流す交流の周波数を変えても、渦電流の浸透深さは変わらない。","試験体にきずが存在すると、コイルのインピーダンスが変化する。"],correct_option_index:3,explanation:"きずによって渦電流の流れが変化すると、その渦電流が作る二次磁束も変化します。この二次磁束の変化が試験コイルに影響を与え、コイルのインピーダンスが変化します。このインピーダンス変化を検出するのが渦電流探傷試験です。"},
  {id:"1.10",question:"1.10~次に示す試験体の特性のうち、渦電流探傷試験に影響を及ぼすものはどれか。正しいものを一つ選び、記号で答えなさい。",choices:["誘電率","導電率","密度","比熱"],correct_option_index:1,explanation:"渦電流の発生量や流れ方は、試験体の導電率と透磁率に大きく影響されます。他の選択肢は直接的な影響を与えません。"},
  {id:"1.11",question:"1.11~次の文は、渦電流探傷試験に影響を与える因子について述べたものである。正しいものを一つ選び、記号で答えなさい。",choices:["試験体の形状・寸法は、渦電流探傷試験に影響を与えない。","試験コイルと試験体との間の距離（リフトオフ）の変化は、渦電流探傷試験に影響を与えない。","試験体の導電率は、渦電流探傷試験に影響を与える。","試験体の熱伝導率は、渦電流探傷試験に影響を与える。"],correct_option_index:2,explanation:"渦電流探傷試験の信号は、試験体の電磁気的特性（導電率、透磁率）や形状・寸法、リフトオフなどに影響を受けます。中でも導電率は、渦電流の流れやすさを直接左右する重要な因子です。"},
  {id:"1.12",question:"1.12~次の文は、渦電流探傷試験について述べたものである。正しいものを一つ選び、記号で答えなさい。",choices:["試験体の形状・寸法は、コイルのインピーダンスに影響を与えない。","試験コイルの充てん率の変化は、コイルのインピーダンスに影響を与えない。","試験体の熱伝導率は、コイルのインピーダンスに影響を与えない。","試験体の比熱は、コイルのインピーダンスに影響を与える。"],correct_option_index:2,explanation:"コイルのインピーダンスは、試験体の電磁気的特性（導電率・透磁率）、形状・寸法、および試験コイルとの相対的な位置関係（リフトオフ、充てん率）によって変化します。熱伝導率や比熱は熱的な特性であり、直接は影響しません。"},
  {id:"1.13",question:"1.13~次のうち、渦電流探傷試験では検出できないものはどれか。正しいものを一つ選び、記号で答えなさい。",choices:["非金属介在物","金属組織の変化","表面粗さ","ラミネーション"],correct_option_index:3,explanation:"ラミネーションは、圧延方向に平行な面状の内部欠陥です。一般的な渦電流探傷試験で流れる渦電流は表面に平行なため、渦電流の流れを妨げないラミネーションは検出が困難です。"},
  {id:"1.14",question:"1.14~次のうち、渦電流探傷試験で検出しやすいきずはどれか。正しいものを一つ選び、記号で答えなさい。",choices:["非金属介在物","金属組織の変化","表面粗さ","ラミネーション"],correct_option_index:3,explanation:"ラミネーションは、圧延方向に平行な面状の内部欠陥です。一般的な渦電流探傷試験で流れる渦電流は表面に平行なため、渦電流の流れを妨げないラミネーションは検出が困難です。"},
  {id:"1.15",question:"1.15~次の文は、渦電流探傷試験の適用について述べたものである。正しいものを一つ選び、記号で答えなさい。",choices:["鋼材の深いきずの検出はできない。","セラミック材料のきずの検出ができる。","材料の非導電性被膜厚さの測定はできない。","肉厚の測定はできない。"],correct_option_index:0,explanation:"渦電流は表皮効果により試験体の表面近くに集中して流れるため、表面から深い位置にあるきずの検出は困難です。"},
  {id:"1.20",question:"次の文は、渦電流探傷試験の適用について述べたものである。正しいものを一つ選び、記号で答えなさい。",choices:["溶接部の内部欠陥の検出に広く用いられている。","表面に開口しているきずの検出はできない。","非導電性皮膜の厚さ測定ができる。","セラミックスの探傷に広く用いられている。"],correct_option_index:2,explanation:"導体上の非導電性皮膜（塗装など）の厚さが変わると、コイルと導体との距離（リフトオフ）が変化するため、コイルのインピーダンスが変化します。これを利用して皮膜の厚さを測定することができます。"},
  {id:"1.21",question:"次の文は、渦電流探傷試験の適用について述べたものである。正しいものを一つ選び、記号で答えなさい。",choices:["鋼材の焼入れ深さの測定はできない。","セラミックス製の部品の検査ができる。","きずの長さ、深さ、幅を正確に測定できる。","きずの種類を正確に識別できる。"],correct_option_index:0,explanation:"鋼材の焼入れ深さの測定は、渦電流探傷試験の応用例の一つです。焼入れによって金属組織が変化し、透磁率や導電率が変わることを利用します。ただし、一般的に「測定はできない」という記述は、限定的な条件下での話や、他の選択肢との比較で判断する必要があります。（この問題では他の選択肢が明確に誤り）"},
  {id:"1.22",question:"1.22~渦電流探傷試験を適用する場合、検査項目として不適切なものは、次のうちどれか。正しいものを一つ選び、記号で答えなさい。",choices:["きずの検出","材質判別","厚さ測定","応力測定"],correct_option_index:3,explanation:"渦電流探傷試験は、きず検出、材質判別（導電率・透磁率測定）、厚さ測定（導体厚・めっき厚）などに適用されますが、応力そのものを直接測定することは一般的ではありません。（応力によって透磁率が変化する現象はありますが、主目的ではありません）"},
  {id:"1.23",question:"1.23~渦電流探傷試験の短所は、次のうちどれか。正しいものを一つ選び、記号で答えなさい。",choices:["検査速度が遅い。","放射線を使用するため、安全管理が必要である。","検出感度が低い。","内部きずの検出は困難である。"],correct_option_index:3,explanation:"渦電流探傷試験の短所は、表皮効果により渦電流が表面に集中するため、内部のきずの検出が困難であることです。検査速度は速く、放射線も使用せず、表面きずに対する検出感度は高いのが長所です。"},
  {id:"1.24",question:"1.24~次の文は、渦電流探傷試験の長所と短所について述べたものである。正しいものを一つ選び、記号で答えなさい。",choices:["長所は、内部きずの検出ができることである。","短所は、きずを電気信号として取り出せることである。","長所は、非接触で高速探傷ができることである。","短所は、試験体が汚れていても探傷できることである。"],correct_option_index:2,explanation:"渦電流探傷試験の大きな長所は、コイルを試験体に接触させる必要がなく、高速で検査できることです。これは自動化に適しています。"},
  {id:"1.25",question:"1.25~次の文は、渦電流探傷試験の長所について述べたものである。正しいものを一つ選び、記号で答えなさい。",choices:["試験体内部のきずが検出できる。","非導電体の探傷試験ができる。","非接触で探傷試験ができる。","きずの形状が検出できる。"],correct_option_index:2,explanation:"渦電流探傷試験の長所の一つは、試験コイルを試験体に接触させる必要がないことです。磁束は空間を伝わって導体に到達するため、非接触での検査が可能です。"},
  {id:"1.26",question:"次の文は、渦電流探傷試験の特徴について述べたものである。正しいものを一つ選び、記号で答えなさい。",choices:["試験結果は、材質の導電率、透磁率などの影響を受けない。","検査結果が直ちに得られるので、自動化に適している。","試験周波数が低いほど、表面のきずの検出能は向上する。","内部きずの検出に適している。"],correct_option_index:1,explanation:"渦電流探傷試験は、きずを電気信号としてリアルタイムで検出できるため、インライン検査などの自動化に非常に適しています。"},
  {id:"1.27",question:"次の文は、渦電流探傷試験の特徴について述べたものである。正しいものを一つ選び、記号で答えなさい。",choices:["きずの指示は出るが、材質の影響は受けない。","接触媒質を必要としない。","内部欠陥の検出に優れている。","装置が複雑で高価である。"],correct_option_index:1,explanation:"超音波探傷試験では水や油などの接触媒質が必要ですが、渦電流探傷試験は非接触で検査できるため、接触媒質は不要です。"},
  {id:"1.28",question:"次の文は、渦電流探傷試験の特徴について述べたものである。正しいものを一つ選び、記号で答えなさい。",choices:["試験体表面が粗くても影響を受けない。","試験体の形状・寸法の影響を受けない。","きずの方向性の影響を受けない。","消耗品はほとんどなく、維持費が安い。"],correct_option_index:3,explanation:"渦電流探傷試験は、プローブと装置で構成され、超音波探傷の探触子や磁粉探傷の磁粉・検査液のような定期的に交換が必要な消耗品がほとんどなく、維持費が比較的安いという長所があります。"},
  {id:"1.29",question:"次の文は、渦電流探傷試験の特徴について述べたものである。正しいものを一つ選び、記号で答えなさい。",choices:["きずの寸法が正確に分かる。","試験体の内部のきずを検出できる。","試験周波数が高いほど、きずの検出感度が高い。","きずの種類を正確に識別できる。"],correct_option_index:2,explanation:"一般的に、試験周波数を高くすると渦電流がより表面に集中するため、表面近傍の微小なきずに対する検出感度は向上します。ただし、浸透深さは浅くなります。"},
  {id:"1.30",question:"次の文は、渦電流探傷試験の特徴について述べたものである。正しいものを一つ選び、記号で答えなさい。",choices:["きずの深さを正確に測定できる。","試験体の磁気特性の影響を受けない。","探傷結果を電気信号として取り出すことができる。","非導電体のきずを検出できる。"],correct_option_index:2,explanation:"渦電流探傷試験では、きずによるインピーダンスの変化を電気信号として直接取り出すことができます。これにより、自動化やデータ記録が容易になります。"},
  {id:"1.31",question:"次の文は、渦電流探傷試験の特徴について述べたものである。正しいものを一つ選び、記号で答えなさい。",choices:["検査速度は遅いが、高感度である。","非導電体の検査はできない。","接触媒質が必要である。","きずの形状の判定が容易である。"],correct_option_index:1,explanation:"渦電流探傷試験は導体に渦電流を流すことが原理であるため、電気を通さない非導電体の検査はできません。"},
  {id:"1.32",question:"1.32~次の文は、渦電流探傷試験と他の非破壊試験との比較について述べたものである。正しいものを一つ選び、記号で答えなさい。",choices:["磁粉探傷試験と同様に、試験体内部のきずの検出ができる。","浸透探傷試験と同様に、接触媒質が必要である。","超音波探傷試験と同様に、きずの寸法が測定できる。","放射線透過試験と異なり、人体に対する安全管理は容易である。"],correct_option_index:3,explanation:"渦電流探傷試験は、放射線（X線やガンマ線）を使用しないため、放射線透過試験のような被ばくに対する厳重な安全管理は不要であり、取り扱いが比較的容易です。"},
  {id:"1.33",question:"1.33~次の文は、渦電流探傷試験と他の非破壊試験法との比較について述べたものである。正しいものを一つ選び、記号で答えなさい。",choices:["浸透探傷試験に比べて、表面に開口していないきずの検出ができる。","超音波探傷試験に比べて、内部きずの検出能が高い。","磁粉探傷試験に比べて、きずの種類の識別が容易である。","放射線透過試験に比べて、きずの深さの測定が容易である。"],correct_option_index:0,explanation:"浸透探傷試験は、きずが表面に開口していないと指示模様が現れません。一方、渦電流探傷試験は、表面直下の開口していないきず（サブサーフェス欠陥）も検出可能です。"},
  {id:"1.34",question:"1.34~次の文は、渦電流探傷試験と他の非破壊試験法との比較について述べたものである。正しいものを一つ選び、記号で答えなさい。",choices:["浸透探傷試験と同様に、多孔質材料の検査に適している。","磁粉探傷試験と同様に、強磁性体の検査に限定される。","超音波探傷試験と同様に、検査に接触媒質を必要としない。","放射線透過試験と同様に、体積を有するきずの検出に適している。"],correct_option_index:3,explanation:"渦電流は、きずによる体積の変化をインピーダンスの変化として捉えます。放射線透過試験も、きずによる厚さの変化（体積の変化）を透過線量の差として捉えるため、どちらも体積を有するきずの検出に適していると言えます。（ただし、検出原理や対象は異なります）"},
  {id:"1.35",question:"1.35~次の文は、渦電流探傷試験の規格について述べたものである。正しいものを一つ選び、記号で答えなさい。",choices:["技術者の資格及び認証は、JIS Z 2305で規定されている。","用語は、JIS G 0563で規定されている。","標準試験片は、JIS G 0583で規定されている。","一般通則は、JIS G 0567で規定されている。"],correct_option_index:0,explanation:"非破壊試験技術者の資格及び認証に関する日本の国家規格は、JIS Z 2305「非破壊試験-技術者の資格及び認証」です。"},
  {id:"1.36",question:"1.36~次の文は、渦電流探傷試験の規格について述べたものである。正しいものを一つ選び、記号で答えなさい。",choices:["用語は、JIS Z 2305で規定されている。","用語は、JIS G 0563で規定されている。","用語は、JIS G 0583で規定されている。","用語は、JIS G 0567で規定されている。"],correct_option_index:1,explanation:"渦電流探傷試験に関する用語は、JIS G 0563「鉄鋼-渦電流探傷試験-用語」で規定されています。"},
  {id:"1.37",question:"1.37~次の文は、渦電流探傷試験の規格について述べたものである。正しいものを一つ選び、記号で答えなさい。",choices:["JIS Z 2305 は、非破壊試験技術者のレベルを3段階に区分し規定している。","JIS G 0563 は、渦電流探傷試験の一般原則について規定している。","JIS G 0583 は、渦電流探傷装置の性能測定方法について規定している。","JIS G 0567 は、渦電流探傷試験の用語について規定している。"],correct_option_index:0,explanation:"JIS Z 2305では、非破壊試験技術者のレベルを、レベル1、レベル2、レベル3の3段階に区分して規定しています。"},
  {id:"2.1",question:"2.1~次の文は、2つの電荷Q₁, Q₂に働く力について述べたものである。正しいものを一つ選び、記号で答えなさい。",choices:["電荷との積が負のとき、2つの電荷の間には引力が働く。","2つの電荷に働く力は、電荷の大きさに比例し距離に反比例する。","電荷と電荷の間に力が働く現象をレンツの法則という。","電荷 Q₁と Q₂ の間の距離を2倍にすると、力は元の1/2となる。"],correct_option_index:0,explanation:"クーロンの法則によれば、2つの点電荷の間に働く力は、電荷の積が負（異符号）のときに引力となります。力は距離の2乗に反比例するため、距離が2倍になると力は1/4になります。"},
  {id:"2.2",question:"2.2~1秒間に3.1×10¹⁸個の自由電子が導体を移動するときの電流の値はいくらか。次の中から最も近い値を一つ選び、記号で答えなさい。ただし、電子1個の電荷は1.6×10⁻¹⁹Cとする。",choices:["3.8 A","5.0 A","0.5 A","2.0 A"],correct_option_index:2,explanation:"電流は単位時間あたりに移動する電荷の量です。電流 I = (電子の数) × (電子1個の電荷) = (3.1×10¹⁸) × (1.6×10⁻¹⁹) = 0.496 A ≈ 0.5 A となります。"},
  {id:"2.3",question:"2.3~抵抗のみの回路に3Vの直流電圧を加えたら200mAの直流電流が流れた。このとき回路の抵抗Rはいくらか。次の中から最も近い値を一つ選び、記号で答えなさい。",choices:["R=7.5 Ω","R=15 Ω","R=30 Ω","R=45Ω"],correct_option_index:1,explanation:"オームの法則 V=IR より、R = V/I です。電流をアンペアに変換し(200mA = 0.2A)、R = 3V / 0.2A = 15Ω となります。"},
    {id:"2.4",question:"2.4~図2.1に示す3本の抵抗からなる回路の合成抵抗Rは何オームか。次の中から最も近いものを一つ選び、記号で答えなさい。",choices:["2 kΩ","1 kΩ","0.5 kΩ","0.2 kΩ"],correct_option_index:1,explanation:"並列接続された2本の1kΩの合成抵抗は (1*1)/(1+1) = 0.5kΩ です。これに直列の0.5kΩを足すと、全体の合成抵抗は 0.5kΩ + 0.5kΩ = 1kΩ となります。"},
  {id:"2.5",question:"2.5~次の文は、金属の抵抗率について述べたものである。正しいものを一つ選び、記号で答えよ。",choices:["電気抵抗は抵抗率に反比例する。","抵抗率の逆数を導電率という。","抵抗率の単位は(Ω/m)である。","抵抗率は形状によって変化する。"],correct_option_index:1,explanation:"抵抗率は物質固有の値で、その逆数が導電率です。電気抵抗は抵抗率に比例し、単位は[Ω・m]です。"},
  {id:"2.6",question:"2.6~磁力線によって磁界の何を表すことができるか。次の中から最も適切なものを一つ選び、記号で答えなさい。",choices:["磁界の密度","磁界の方向および強さ","磁界の位相","磁界の位相および方向"],correct_option_index:1,explanation:"磁力線は、その接線が磁界の方向を、その密度が磁界の強さを表します。"},
  {id:"2.7",question:"2.7~次の式は、材料に加える磁界と材料中の磁束密度の関係を示したものである。次の中から正しいものを一つ選び、記号で答えなさい。ただし、H:磁界の強さ(A/m), B:磁束密度(T), σ:導電率(S/m), μ:透磁率(H/m)である。",choices:["H = μσB","B = μH","H = σB","B = σH"],correct_option_index:1,explanation:"磁束密度Bは、磁界の強さHと物質の透磁率μの積で定義されます。"},
  {id:"2.8",question:"2.8~次に示す磁束密度Bを表す式の中から正しいものを一つ選び、記号で答えなさい。なお、図2.2に示すようにS: 面積、Φ: 磁束である。",choices:["B = Φ - S","B = S - Φ","B = S / Φ","B = Φ / S"],correct_option_index:3,explanation:"磁束密度Bは、単位面積Sあたりの磁束Φとして定義されます。"},
  {id:"2.9",question:"2.9~磁束密度の単位はどれか。次の中から正しいものを一つ選び、記号で答えよ。",choices:["H/m","H","A/m","T"],correct_option_index:3,explanation:"磁束密度の単位はT (テスラ) です。H/mは透磁率、Hはインダクタンス、A/mは磁界の強さの単位です。"},
  {id:"2.10",question:"2.10~次の中から強磁性材料を選びなさい。",choices:["鉄","アルミニウム","銅","チタン"],correct_option_index:0,explanation:"強磁性を示す代表的な元素は鉄、ニッケル、コバルトです。アルミニウムやチタンは常磁性体、銅は反磁性体です。"},
  {id:"2.11",question:"2.11~次の式は、真直ぐな電線に電流I(A)が流れているとき、電線中心からr (m) 離れた点の磁界の強さ H(A/m) を表わすものである。次の中から正しいものを一つ選び、記号で答えなさい。",choices:["H = 2πrI","H = I / (2πr)","H = 1 / (2πr)","H = rI / (2π)"],correct_option_index:1,explanation:"アンペールの法則から導かれる、無限長直線電流が作る磁界の強さの公式です。"},
  {id:"2.12",question:"2.12~次の文は、コイルによって生じる磁界について述べたものである。次の中から正しいものを一つ選び、記号で答えなさい。",choices:["磁界の強さはコイルに流す電流に反比例する。","コイルに流す電流の向きを逆にしても、磁界の向きは変わらない。","磁界の強さはコイルからの距離によっては変わらない。","磁界の強さはコイルの巻数に比例する。"],correct_option_index:3,explanation:"コイルが作る磁界の強さは、電流の大きさと巻数に比例します。"},
  {id:"2.13",question:"2.13~次の文は、直線状の導体に流した電流とその電流が作る磁界の関係について述べたものである。次の中から正しいものを一つ選び、記号で答えなさい。",choices:["磁界は導体の長手方向に発生する。","磁界は導体の周方向に発生する。","磁界は導体の半径方向に発生する。","磁界の向きは導体の向きとは無関係である。"],correct_option_index:1,explanation:"アンペアの右ネジの法則により、直線電流が作る磁界は電流の周りの周方向に発生します。"},
  {id:"2.14",question:"2.14~次の材料のうち、コイルに挿入するとコイルの作る磁束が増加するのはどれか。次のうちから正しいものを一つ選び、記号で答えなさい。ただし、コイルに流す電流は一定とする。",choices:["鉄棒","エボナイト棒","銅棒","アルミニウム棒"],correct_option_index:0,explanation:"鉄は透磁率が非常に高い強磁性体なので、コイルに挿入すると磁束が鉄棒に集中し、全体の磁束が増加します。"},
  {id:"2.15",question:"2.15~次の文は、コイルのインダクタンスについて述べたものである。正しいものを一つ選び、記号で答えなさい。ただし、コイルが置かれた媒質の電気・磁気的性質は一定とする。",choices:["コイルの巻数に比例する。","コイルの巻数の2乗に比例する。","コイルの巻数に反比例する。","コイルの巻数の2乗に反比例する。"],correct_option_index:1,explanation:"コイルの自己インダクタンスは、巻数の2乗に比例します。"},
  {id:"2.16",question:"2.16~次の文は、コイルのインダクタンスについて述べたものである。正しいものを一つ選び、記号で答えなさい。",choices:["コイルのインダクタンスは巻数で変化するが、形状や寸法により変化することはない。","形状と寸法が同じ2つのボビンにコイルを巻いた。このとき、直径の太い線を巻くより細い直径の線を巻く方がインダクタンスは増加する。","コイルのインダクタンスが大きいほど、コイルが作る磁束は小さくなる。","コイル内に導体が存在すれば、導体に誘導された渦電流により磁束が増加しインダクタンスが増加する。"],correct_option_index:1,explanation:"同じスペースに巻く場合、細い線の方がより多くの巻数を巻けるため、インダクタンスは増加します。また、コイル内に導体が存在すると、渦電流が作る逆向きの磁束により、実効的なインダクタンスは減少します。"},
  {id:"2.17",question:"2.17~次の文は、コイルのインダクタンスについて述べたものである。次の中から正しいものを一つ選び、記号で答えなさい。",choices:["コイルの巻数の2乗と媒質の透磁率に反比例する。","コイルの巻数の2乗に反比例し、媒質の透磁率に反比例する。","コイルの巻数の2乗に比例し、媒質の透磁率に反比例する。","コイルの巻数の2乗と媒質の透磁率に比例する。"],correct_option_index:3,explanation:"コイルのインダクタンスは、巻数の2乗と、コイル内部の媒質の透磁率の両方に比例します。"},
  {id:"2.18",question:"2.18~コイルのインダクタンスは、巻数を2倍にすると何倍となるか。次の中から正しいものを一つ選び、記号で答えなさい。",choices:["1/2倍","√2倍","2倍","4倍"],correct_option_index:3,explanation:"コイルのインダクタンスは巻数の2乗に比例するため、巻数が2倍になるとインダクタンスは2² = 4倍になります。"},
  {id:"2.19",question:"2.19~一方のコイルに交流電流を流すと近くに置いたもう一方のコイルに起電力が誘導される現象を何というか。次の中から正しいものを一つ選び、記号で答えなさい。",choices:["静電誘導","表皮効果","自己誘導","相互誘導"],correct_option_index:3,explanation:"一方のコイルの電流変化が、もう一方のコイルに電圧を誘導する現象を相互誘導といいます。"},
  {id:"2.20",question:"2.20~コイルに流れる電流の変化による磁束の変化によって、そのコイル自身に起電力が生じる現象を何というか。次の中から正しいものを一つ選び、記号で答えなさい。",choices:["自己誘導","相互誘導","静電誘導","表皮効果"],correct_option_index:0,explanation:"コイル自身の電流変化によって、コイル自身に起電力が生じる現象を自己誘導といいます。"},
  {id:"2.21",question:"2.21~コイルの中を振幅一定の交流磁束が貫いているとき、コイルに発生する起電力の振幅が大きくなるのは次のうちどれか。正しいものを一つ選び、記号で答えなさい。",choices:["交流磁束の周波数が低くなったとき","交流磁束の周波数が高くなったとき","交流磁束の位相が遅れたとき","交流磁束の位相が進んだとき"],correct_option_index:1,explanation:"誘導起電力の大きさは磁束の時間変化率に比例します。交流磁束の場合、周波数が高いほど時間変化率が大きくなるため、起電力の振幅も大きくなります。"},
  {id:"2.22",question:"2.22~図2.3は、コイルの一方に交流定電流電源、もう一方に交流電圧計が接続されている状態を示している。このとき、電源の周波数を2倍にしたら交流電圧計の指示はどうなるか。次の中から正しいものを一つ選び、記号で答えよ。",choices:["1/2になる。","変わらない。","2倍になる。","4倍になる。"],correct_option_index:2,explanation:"交流定電流電源は電流の振幅を一定に保ちます。コイルの電圧(誘導起電力)の振幅は、電流の振幅と周波数に比例するため、周波数を2倍にすると電圧も2倍になります。"},
  {id:"2.23",question:"2.23~次の文は、電磁誘導について述べたものである。正しいものを一つ選び、記号で答えなさい。",choices:["変圧器において1次側に交流電圧を加えると2次側に交流電圧が発生する現象を自己誘導という。","永久磁石をコイルに出し入れするとコイルに起電力が発生する現象を相互誘導という。","コイルに交流電流を流すと逆起電力が発生する現象を自己誘導という。","交流電流を流した試験コイルを導体に近づけると渦電流が誘導される現象を自己誘導という。"],correct_option_index:2,explanation:"コイルに流れる電流の変化を妨げる向きに発生する起電力（逆起電力）は、自己誘導によるものです。aは相互誘導、bは電磁誘導（自己誘導の一例）、dは相互誘導に近いです。"},
  {id:"2.24",question:"2.24~次の文は、試験コイルの電磁誘導現象について述べたものである。正しいものを一つ選び、記号で答えなさい。",choices:["コイルを貫く磁束による誘導起電力は、磁束の時間変化割合に比例する。","コイルに永久磁石を入れて静止させておくと、コイルには起電力が発生する。","コイルを貫く磁束による誘導起電力は、コイルの巻数に反比例する。","変圧器の1次側に直流電圧を加えると、2次側にはコイルの巻数比で決まる大きさの直流電圧が発生する。"],correct_option_index:0,explanation:"ファラデーの電磁誘導の法則そのものです。誘導起電力は磁束の変化によって生じるため、静止した磁石(b)や直流電圧(d)では定常状態では発生しません。また、起電力は巻数に比例します(c)。"},
  {id:"2.25",question:"2.25~図2.4に示すように、A、B2つのコイルを直角に配置し、コイルAにiₐ = Iₘsin(ωt)なる電流を流したとき、コイルBに観測される電圧νᵦはどのようになるか。次の中から正しいものを一つ選び、記号で答えなさい。",choices:["νᵦ = 0","νᵦ = Vₘsin(ωt - π/2)","νᵦ = Vₘsin(ωt - π/4)","νᵦ = Vₘcos(ωt)"],correct_option_index:0,explanation:"コイルAが作る磁束は、コイルBの断面を貫通しない（鎖交しない）ため、磁束が変化してもコイルBには誘導起電力が発生しません。"},
  {id:"2.26",question:"2.26~次の文は、コイルの電磁誘導現象について述べたものである。正しいものを一つ選び、記号で答えなさい。",choices:["コイルに直流電流を流すと自己誘導によって直流の起電力が発生する。","コイルに交流の磁束が作用すると直流電圧が生じる。","コイルに直流の磁束が作用すると、コイルに直流電圧が生じる。","コイルに交流電流を流すと、自己誘導によってコイル自身に交流の起電力が生じる。"],correct_option_index:3,explanation:"自己誘導は電流の変化によって生じます。交流電流は時間的に変化するため、自己誘導によって交流の起電力が発生します。直流電流では定常状態では変化がないため起電力は生じません。"},
  {id:"2.27",question:"2.27~次の文は、導体内に誘導される渦電流の作用について述べたものである。正しいものを一つ選び、記号で答えなさい。",choices:["渦電流が流れると導体の導電率が変化する。","渦電流が流れると導体が熱を吸収する。","渦電流が流れると磁界が発生する。","渦電流はコイルが作る磁界を増加させる。"],correct_option_index:2,explanation:"電流が流れると、その周りには必ず磁界が発生します（アンペールの法則）。渦電流も電流の一種なので、磁界を発生させます。この磁界が、元の磁束変化を妨げる向きに生じます。"},
  {id:"2.28",question:"2.28~次の文は、渦電流について述べたものである。正しいものを一つ選び、記号で答えなさい。",choices:["導体に直流磁束を作用させると導体中に渦電流が誘導される。","導体に交流磁束を作用させると導体中に渦電流が誘導される。","交流磁束によって導体の外部空間にも渦電流が誘導される。","導体内に生じた渦電流は表面きずの影響を受けることがない。"],correct_option_index:1,explanation:"渦電流は磁束の「変化」によって誘導されます。したがって、時間的に変化する交流磁束によって誘導されます。直流磁束では誘導されません。"},
  {id:"2.29",question:"2.29~正弦波交流電流の1周期が125μsのとき、電流の周波数はいくらか。次の中から最も近い値を一つ選び、記号で答えなさい。",choices:["64 kHz","32 kHz","8 kHz","4 kHz"],correct_option_index:2,explanation:"周波数fは周期Tの逆数です (f = 1/T)。f = 1 / (125 × 10⁻⁶ s) = 8000 Hz = 8 kHz。"},
  {id:"2.30",question:"2.30~次の式は、正弦波交流電圧v(t)=Vₘsin(ωt+π/2)に対し、これと同一周波数で振幅が等しく、1/4周期だけ位相が遅れている電圧について示したものである。正しいものを一つ選び、記号で答えよ。",choices:["v(t) = 2Vₘsin(ωt - π/2)","v(t) = Vₘsin(ωt)","v(t) = Vₘsin(2ωt + π/2)","v(t) = Vₘsin(ωt + π)"],correct_option_index:1,explanation:"1周期は2πラジアンなので、1/4周期はπ/2ラジアンに相当します。元の位相(ωt+π/2)からπ/2だけ遅らせる（引く）と、新しい位相は (ωt+π/2) - π/2 = ωt となります。したがって、v(t) = Vₘsin(ωt) です。"},
  {id:"2.31",question:"2.31~次の文は、回路素子に交流電圧を加えたときの電圧と電流の位相について述べたものである。正しいものを一つ選び、記号で答えよ。",choices:["インダクタンスの場合、電圧は電流に対してπ/4遅れる。","インダクタンスの場合、電圧と電流は同位相である。","抵抗の場合、電圧は電流に対してπ/4進む。","抵抗の場合、電圧と電流は同位相である。"],correct_option_index:3,explanation:"抵抗では電圧と電流は同位相です。インダクタンスでは電圧が電流に対してπ/2進みます。"},
  {id:"2.32",question:"2.32~図2.5は交流正弦波電流と電圧の波形を示している。電圧の位相は電流に対してどのような関係にあるか。次のうちから正しいものを一つ選び、記号で答えなさい。",choices:["π/2 (rad)進んでいる。","π/2 (rad)遅れている。","π/4 (rad)進んでいる。","π/4 (rad)遅れている。"],correct_option_index:0,explanation:"図2.5を見ると、電圧波形(v(t))のピークが電流波形(i(t))のピークよりも時間的に早く現れています。電圧が最大値を取る(ωt=0)とき、電流は0であり、その後電圧が0になる(ωt=π/2)ときに電流が最大値を取るため、電圧は電流に対してπ/2進んでいます。"},
  {id:"2.33",question:"2.33~抵抗に正弦波交流電流が流れているとき、抵抗両端の電圧に対して電流の位相はどのような関係となるか。次のうちから正しいものを一つ選び、記号で答えなさい。",choices:["同位相である。","π/2 (rad)進む。","π/2 (rad)遅れる。","π (rad)遅れる。"],correct_option_index:0,explanation:"抵抗回路では、オームの法則(v=iR)が瞬時値でも成立するため、電圧と電流の位相は常に同じ（同位相）です。"},
  {id:"2.34",question:"2.34~インダクタンスに交流電圧を加えて電流を流したとき、電圧に対する電流の位相はどうなるか。次のうちから正しいものを一つ選び、記号で答えなさい。",choices:["同位相である。","π/2 (rad)遅れる。","π/2 (rad)進む。","π (rad)遅れる。"],correct_option_index:1,explanation:"インダクタンス（コイル）回路では、電流は電圧に対してπ/2ラジアン(90°)遅れます。"},
  {id:"2.35",question:"2.35~次の文は、インダクタンスに交流電流を流したときの、電流に対する電圧の位相について述べたものである。正しいものを一つ選び、記号で答えなさい。",choices:["同位相である。","π/2 (rad)遅れる。","π/2 (rad)進む。","π (rad)進む。"],correct_option_index:2,explanation:"この問題は「電流に対する電圧」の位相を聞いています。電流が電圧に対してπ/2遅れるということは、逆に電圧が電流に対してπ/2進むことを意味します。"},
  {id:"2.36",question:"2.36~コイルに交流電流が流れているとき、コイルのインダクタンスはそのままで抵抗が大きくなると、コイルの端子電圧に対する電流の位相はどうなるか。次の中から正しいものを一つ選び、記号で答えなさい。",choices:["進みが大きくなる。","進みが小さくなる。","遅れが大きくなる。","遅れが小さくなる。"],correct_option_index:3,explanation:"位相差角θは tanθ = (ωL)/R で決まります。抵抗Rが大きくなると、tanθの値は小さくなり、遅れ角θも小さくなります。"},
  {id:"2.37",question:"2.37~試験コイルの両端における電圧と電流の位相差φはどのような関係であらわされるか。次のうちから正しいものを一つ選び、記号で答えなさい。ただし、ω:角周波数(rad/s), L:インダクタンス(H), R:抵抗(Ω)とする。",choices:["φ = tan⁻¹(R/ωL)","φ = tan⁻¹(ωL/R)","φ = tan⁻¹(ωL - R)","φ = tan⁻¹(ωL + R)"],correct_option_index:1,explanation:"インピーダンスの複素数表示 Z = R + jωL において、位相角φは虚数部/実数部の逆正接で与えられます。したがって、tanφ = (ωL)/R となります。"},
  {id:"2.38",question:"2.38~コイルのリアクタンスは次のいずれの式で表わされるか。次の中から正しいものを一つ選び、記号で答えなさい。ただし、f:周波数(Hz), L:コイルのインダクタンス(H)とする。",choices:["1/(2πfL)","L/(2πf)"," (2πf)L","2πfL"],correct_option_index:3,explanation:"コイルの誘導性リアクタンスXₗは、角周波数ωとインダクタンスLの積で与えられます。角周波数ωは2πfなので、Xₗ = ωL = 2πfL となります。選択肢cとdは同じ式ですが、問題集の解答ではdが正解とされています。"},
  {id:"2.39",question:"2.39~次の文は、コイルのリアクタンスについて述べたものである。次の中から正しいものを一つ選び、記号で答えなさい。",choices:["インダクタンスとリアクタンスは逆数の関係にある。","リアクタンスは周波数によらず、一定である。","直流ではリアクタンスは無限に高くなる。","インダクタンスが一定のとき、リアクタンスは周波数に比例する。"],correct_option_index:3,explanation:"コイルのリアクタンス Xₗ = 2πfL の式から、インダクタンスLが一定であれば、リアクタンスは周波数fに比例することがわかります。直流(f=0)ではリアクタンスは0になります。"},
  {id:"2.40",question:"2.40~試験周波数が10kHzのとき、試験コイルの抵抗が3.0Ω、インダクタンスが63.7μHであった。試験コイルのインピーダンスは何Ωとなるか。次のうちから最も近いものを一つ選び、記号で答えなさい。",choices:["2.6Ω","5Ω","16Ω","25Ω"],correct_option_index:1,explanation:"リアクタンス Xₗ = 2πfL = 2π(10×10³) (63.7×10⁻⁶) ≈ 4.0Ω。インピーダンス Z = √(3² + 4²) = √25 = 5Ω。"},
  {id:"2.41",question:"2.41~次の文は、コイルのインピーダンスについて述べたものである。正しいものを一つ選び、記号で答えなさい。",choices:["インピーダンスは抵抗とインダクタンスからなる。","インピーダンスはインダクタンスとリアクタンスからなる。","インピーダンスは抵抗とリアクタンスからなる。","インピーダンスは抵抗とキャパシタンスからなる。"],correct_option_index:2,explanation:"インピーダンスは、交流回路における総合的な抵抗であり、抵抗成分とリアクタンス成分（コイルの場合は誘導性リアクタンス）を合成したものです。"},
  {id:"2.42",question:"2.42~次の式は、抵抗RとリアクタンスXとが直列になった回路のインピーダンスを示したものである。正しいものを一つ選び、記号で答えなさい。",choices:["R + X","R² + X²","√(R² + X²)","√R + √X"],correct_option_index:2,explanation:"インピーダンスZは、抵抗RとリアクタンスXを直角2辺とする直角三角形の斜辺の長さに相当するため、三平方の定理により Z = √(R² + X²) で計算されます。"},
  {id:"2.43",question:"2.43~次の式は、コイルのインピーダンスに関連する関係式を示す。正しいものを一つ選び、記号で答えなさい。ただし、R:抵抗、L:インダクタンス、Z:インピーダンス、θ:位相、f:周波数, ω:角周波数(ω=2πf)である。",choices:["θ = tan⁻¹(ωL/R)","tanθ = (R/ωL)","Z = √R + ωL","Z² = R² + ωL²"],correct_option_index:0,explanation:"インピーダンスの位相角θは、リアクタンス成分(ωL)と抵抗成分(R)の比の逆正接で与えられます。したがって、tanθ = ωL/R であり、θ = tan⁻¹(ωL/R) となります。"},
  {id:"2.44",question:"2.44~次の単位は電磁気に関する単位の記号を挙げたものであるが、リアクタンスの単位はどれか。正しいものを一つ選び、記号で答えなさい。",choices:["Ω","A/m","H","T"],correct_option_index:0,explanation:"リアクタンスは交流回路における抵抗の一種なので、単位は抵抗と同じΩ（オーム）です。"}
];

    // --- DOM取得 ---
    const progressText = document.getElementById('progress-text');
    const questionText = document.getElementById('question-text');
    const speakButton = document.getElementById('speak-button');
    const pauseButton = document.getElementById('pause-button');
    const choicesContainer = document.getElementById('choices-container');
    const explanationContainer = document.getElementById('explanation-container');
    const prevButton = document.getElementById('prev-button');
    const nextButton = document.getElementById('next-button');

    let currentQuestion = 0;
    let isAnswered = false;

    function loadQuestion(questionIndex) {
      const q = quizData[questionIndex];
      currentQuestion = questionIndex;
      isAnswered = false;
      // 進捗表示
      progressText.textContent = `問題 ${questionIndex + 1} / ${quizData.length}`;
      // 問題文
      questionText.textContent = q.question;
      // 選択肢
      choicesContainer.innerHTML = '';
      q.choices.forEach((choice, idx) => {
        const btn = document.createElement('button');
        btn.className = 'choice-btn';
        btn.textContent = choice;
        btn.disabled = false;
        btn.onclick = () => handleChoice(idx, btn);
        choicesContainer.appendChild(btn);
      });
      // 解説
      explanationContainer.textContent = '';
      explanationContainer.classList.remove('visible');
      explanationContainer.style.display = 'none';
      // ボタン色リセット
      Array.from(choicesContainer.children).forEach(btn => {
        btn.classList.remove('correct', 'incorrect');
      });
    }

    function handleChoice(idx, btn) {
      if (isAnswered) return;
      isAnswered = true;
      const q = quizData[currentQuestion];
      // 全選択肢を無効化
      Array.from(choicesContainer.children).forEach((b, i) => {
        b.disabled = true;
        if (i === q.correct_option_index) {
          b.classList.add('correct');
        }
      });
      // 不正解なら赤色
      if (idx !== q.correct_option_index) {
        btn.classList.add('incorrect');
      }
      // 解説表示
      explanationContainer.textContent = q.explanation;
      explanationContainer.style.display = 'block';
      setTimeout(() => {
        explanationContainer.classList.add('visible');
      }, 50);
    }

    prevButton.addEventListener('click', () => {
      let idx = currentQuestion - 1;
      if (idx < 0) idx = quizData.length - 1;
      loadQuestion(idx);
    });
    nextButton.addEventListener('click', () => {
      let idx = currentQuestion + 1;
      if (idx >= quizData.length) idx = 0;
      loadQuestion(idx);
    });

    // 一時停止・再開状態
    let isPaused = false;

    speakButton.addEventListener('click', () => {
      window.speechSynthesis.cancel(); // 前回の読み上げ停止
      const q = quizData[currentQuestion];
      const utterances = [];
      // 問題文
      const qUtter = new window.SpeechSynthesisUtterance(q.question);
      qUtter.lang = 'ja-JP';
      qUtter.rate = 1.2;
      utterances.push(qUtter);
      // 選択肢
      q.choices.forEach((choice, i) => {
        const choiceUtter = new window.SpeechSynthesisUtterance(`${i+1}、${choice}`);
        choiceUtter.lang = 'ja-JP';
        choiceUtter.rate = 1.2;
        utterances.push(choiceUtter);
      });
      // 読み上げ実行
      let idx = 0;
      function speakNext() {
        if (idx < utterances.length) {
          window.speechSynthesis.speak(utterances[idx]);
          utterances[idx].onend = () => {
            idx++;
            speakNext();
          };
        } else {
          // 数秒後に正解と解説を読み上げ
          setTimeout(() => {
            // 正解
            const ansText = `正解は、選択肢${q.correct_option_index+1}。${q.choices[q.correct_option_index]}`;
            const ansUtter = new window.SpeechSynthesisUtterance(ansText);
            ansUtter.lang = 'ja-JP';
            ansUtter.rate = 1.2;
            // 解説
            const expUtter = new window.SpeechSynthesisUtterance(q.explanation);
            expUtter.lang = 'ja-JP';
            expUtter.rate = 1.2;
            window.speechSynthesis.speak(ansUtter);
            ansUtter.onend = () => {
              window.speechSynthesis.speak(expUtter);
              expUtter.onend = () => {
                // 解説の読み上げが終わったら自動で次の問題へ
                let nextIdx = currentQuestion + 1;
                if (nextIdx >= quizData.length) nextIdx = 0;
                loadQuestion(nextIdx);
                // すぐ次の問題の読み上げを自動開始
                setTimeout(() => {
                  speakButton.click();
                }, 400); // 0.4秒だけ間を空ける
              };
            };

          }, 2500);
        }
      }
      speakNext();
    });

    // 一時停止ボタン
    pauseButton.addEventListener('click', () => {
      if (!window.speechSynthesis.speaking) return;
      if (isPaused) {
        window.speechSynthesis.resume();
        isPaused = false;
        pauseButton.innerHTML = '<span aria-label="一時停止">⏸️</span>';
        pauseButton.title = '一時停止';
      } else {
        window.speechSynthesis.pause();
        isPaused = true;
        pauseButton.innerHTML = '<span aria-label="再開">▶️</span>';
        pauseButton.title = '再開';
      }
    });

    // 初期化
    window.addEventListener('DOMContentLoaded', () => {
      loadQuestion(0);
    });
  </script>
</body>
</html>
